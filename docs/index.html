<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POLLUX Download Center</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Geist:wght@400;500;600&family=Geist+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #111111;
            --bg-card: #141414;
            --bg-hover: #1a1a1a;
            --bg-code: #1e1e1e;
            --text-primary: #fafafa;
            --text-secondary: #a1a1a1;
            --text-muted: #666666;
            --border-color: #262626;
            --accent-primary: #818cf8;
            --accent-hover: #6366f1;
            --badge-production: #818cf8;
            --badge-beta: #fbbf24;
            --success: #22c55e;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Geist', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            font-size: 14px;
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }

        header {
            border-bottom: 1px solid var(--border-color);
            padding: 0 24px;
            height: 48px;
            display: flex;
            align-items: center;
            position: sticky;
            top: 0;
            background: rgba(10, 10, 10, 0.8);
            backdrop-filter: blur(8px);
            z-index: 100;
        }

        .header-content {
            max-width: 720px;
            margin: 0 auto;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            font-size: 18px;
            font-weight: 600;
            letter-spacing: -0.02em;
            color: var(--text-primary);
            text-decoration: none;
        }

        .logo span {
            color: var(--accent-primary);
        }

        .header-title {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .header-link {
            font-size: 13px;
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.15s;
        }

        .header-link:hover {
            color: var(--text-primary);
        }

        main {
            flex: 1;
            max-width: 720px;
            margin: 0 auto;
            padding: 32px 24px;
            width: 100%;
        }

        .app-section {
            margin-bottom: 32px;
        }

        .app-title {
            font-size: 18px;
            font-weight: 600;
            letter-spacing: -0.02em;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .app-title a {
            color: var(--text-primary);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: color 0.15s;
        }

        .app-title a:hover {
            color: var(--accent-primary);
        }

        .app-title svg {
            width: 14px;
            height: 14px;
            opacity: 0.4;
        }

        .release-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .release-header {
            padding: 12px 16px;
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            flex-wrap: wrap;
        }

        .release-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .release-header .badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
            text-align: center;
            min-width: 52px;
        }

        .badge-production {
            background: rgba(129, 140, 248, 0.15);
            color: var(--badge-production);
        }

        .badge-beta {
            background: rgba(251, 191, 36, 0.15);
            color: var(--badge-beta);
        }

        .release-header .version {
            font-family: 'Geist Mono', 'SF Mono', monospace;
            font-size: 13px;
            color: var(--text-primary);
            font-weight: 500;
        }

        .release-header .release-date {
            font-size: 12px;
            color: var(--text-muted);
        }

        .platform-buttons {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .platform-btn {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            text-decoration: none;
            transition: all 0.15s;
            border: 1px solid var(--border-color);
            background: var(--bg-card);
            color: var(--text-secondary);
            cursor: pointer;
        }

        .platform-btn:hover {
            border-color: var(--accent-primary);
            color: var(--text-primary);
        }

        .platform-btn.active {
            background: var(--accent-primary);
            color: #0a0a0a;
            border-color: var(--accent-primary);
        }

        .platform-btn.active:hover {
            background: var(--accent-hover);
            border-color: var(--accent-hover);
        }

        .platform-btn.expanded {
            background: var(--bg-hover);
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        .platform-btn.inactive {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .platform-btn svg {
            width: 14px;
            height: 14px;
        }

        .platform-btn .chevron {
            width: 10px;
            height: 10px;
            transition: transform 0.2s;
            margin-left: 2px;
        }

        .platform-btn.expanded .chevron {
            transform: rotate(180deg);
        }

        .install-panel {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
        }

        .install-panel.expanded {
            max-height: 400px;
        }

        .install-panel-content {
            padding: 16px;
        }

        .install-method {
            margin-bottom: 16px;
        }

        .install-method:last-child {
            margin-bottom: 0;
        }

        .install-method-title {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .install-method-title svg {
            width: 14px;
            height: 14px;
        }

        .code-block {
            position: relative;
            background: var(--bg-code);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            overflow: hidden;
        }

        .code-block pre {
            padding: 12px 48px 12px 12px;
            font-family: 'Geist Mono', 'SF Mono', monospace;
            font-size: 12px;
            line-height: 1.5;
            color: var(--text-primary);
            overflow-x: auto;
            margin: 0;
            white-space: pre-wrap;
            word-break: break-all;
        }

        .copy-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--bg-hover);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 6px;
            cursor: pointer;
            color: var(--text-secondary);
            transition: all 0.15s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .copy-btn:hover {
            background: var(--bg-card);
            color: var(--text-primary);
            border-color: var(--accent-primary);
        }

        .copy-btn.copied {
            background: rgba(34, 197, 94, 0.2);
            border-color: var(--success);
            color: var(--success);
        }

        .copy-btn svg {
            width: 14px;
            height: 14px;
        }

        .license-banner {
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.2);
            border-radius: 6px;
            padding: 10px 12px;
            margin-top: 20px;
            display: flex;
            align-items: flex-start;
            gap: 8px;
            font-size: 13px;
        }

        .license-banner svg {
            width: 16px;
            height: 16px;
            color: #fbbf24;
            flex-shrink: 0;
            margin-top: 1px;
        }

        .license-banner p {
            color: #fbbf24;
            margin: 0;
            line-height: 1.5;
        }

        .license-banner a {
            color: #fcd34d;
            font-weight: 500;
            text-decoration: none;
        }

        .license-banner a:hover {
            text-decoration: underline;
        }

        .license-section {
            margin-top: 20px;
        }

        .license-toggle {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: border-color 0.15s;
            font-size: 13px;
        }

        .license-toggle:hover {
            border-color: var(--accent-primary);
        }

        .license-toggle h3 {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .license-toggle h3 svg {
            width: 14px;
            height: 14px;
            color: var(--accent-primary);
        }

        .license-toggle .chevron {
            width: 16px;
            height: 16px;
            color: var(--text-muted);
            transition: transform 0.2s;
        }

        .license-toggle.expanded {
            border-radius: 8px 8px 0 0;
            border-bottom: none;
        }

        .license-toggle.expanded .chevron {
            transform: rotate(180deg);
        }

        .license-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-top: none;
            border-radius: 0 0 8px 8px;
        }

        .license-content.expanded {
            max-height: 2000px;
        }

        .license-content pre {
            padding: 16px;
            font-family: 'Geist Mono', monospace;
            font-size: 11px;
            line-height: 1.6;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
            margin: 0;
            background: var(--bg-secondary);
            border-radius: 0 0 7px 7px;
        }

        footer {
            padding: 16px 24px;
            text-align: center;
            border-top: 1px solid var(--border-color);
        }

        footer p {
            font-size: 12px;
            color: var(--text-muted);
        }

        footer a {
            color: var(--text-secondary);
            text-decoration: none;
        }

        footer a:hover {
            color: var(--text-primary);
        }

        @media (max-width: 640px) {
            main {
                padding: 20px 16px;
            }

            .release-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .platform-buttons {
                width: 100%;
            }

            .platform-btn {
                flex: 1;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <a href="https://pollux.ai" class="logo"><img src="pollux_logo_dark.png" alt="POLLUX" height="20"></a>
            <span class="header-title">Download Center</span>
        </div>
    </header>

    <main id="app-container"></main>

    <footer>
        <p><a href="https://pollux.ai">© 2025 POLLUX.ai</a> · All rights reserved</p>
    </footer>

    <script>
        const apps = [
            { name: 'ergon-markdown', binary: 'ergon-markdown' },
            { name: 'ergon-sullivan', binary: 'slv' },
            { name: 'ergon-vibe', binary: 'ergon-vibe' },
        ];

        const icons = {
            external: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 3h6v6"/><path d="M10 14 21 3"/><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/></svg>`,
            windows: `<svg viewBox="0 0 24 24" fill="currentColor"><path d="M0 3.449L9.75 2.1v9.451H0m10.949-9.602L24 0v11.4H10.949M0 12.6h9.75v9.451L0 20.699M10.949 12.6H24V24l-12.9-1.801"/></svg>`,
            linux: `<svg viewBox="0 0 16 16" fill="currentColor"><path d="M13.281 11.156a.84.84 0 0 1 .375.297c.084.125.143.276.18.453.02.104.044.2.07.29a1.772 1.772 0 0 0 .219.476c.047.073.11.153.188.242.067.073.127.167.18.281a.793.793 0 0 1 .077.328.49.49 0 0 1-.093.305.944.944 0 0 1-.235.219c-.12.083-.245.156-.375.219-.13.062-.26.127-.39.195a3.624 3.624 0 0 0-.555.328c-.156.115-.313.26-.469.438a2.815 2.815 0 0 1-.625.523 1.471 1.471 0 0 1-.383.172c-.13.036-.26.06-.39.07-.302 0-.552-.052-.75-.156-.198-.104-.37-.294-.516-.57-.042-.079-.083-.128-.125-.149a.774.774 0 0 0-.203-.055L8.67 15c-.26-.02-.525-.031-.796-.031a4.28 4.28 0 0 0-.672.054c-.229.037-.456.081-.68.133-.046.01-.093.05-.14.117a1.7 1.7 0 0 1-.196.227 1.106 1.106 0 0 1-.335.219 1.475 1.475 0 0 1-.555.101c-.172 0-.357-.018-.555-.054a1.82 1.82 0 0 1-.531-.18 3.578 3.578 0 0 0-.953-.328c-.313-.057-.643-.11-.992-.156a3.392 3.392 0 0 1-.344-.063.774.774 0 0 1-.29-.133.705.705 0 0 1-.194-.219.78.78 0 0 1-.079-.351c0-.162.021-.318.063-.469.042-.15.065-.31.07-.476 0-.115-.008-.227-.023-.336a3.53 3.53 0 0 1-.032-.352c0-.265.063-.46.188-.586.125-.125.307-.224.547-.297a.99.99 0 0 0 .297-.148 2.27 2.27 0 0 0 .234-.203 1.86 1.86 0 0 0 .203-.242c.063-.089.133-.178.211-.266a.114.114 0 0 0 .024-.07c0-.063-.003-.123-.008-.18l-.016-.188c0-.354.055-.71.164-1.07.11-.36.253-.71.43-1.055a9.08 9.08 0 0 1 .594-.992c.218-.317.435-.612.648-.883a4.35 4.35 0 0 0 .68-1.203c.15-.416.229-.87.234-1.36 0-.207-.01-.413-.031-.616a6.122 6.122 0 0 1-.031-.625c0-.417.047-.792.14-1.125.094-.334.24-.62.438-.86s.456-.419.773-.539C7.474.075 7.854.01 8.296 0c.527 0 .946.104 1.259.313.312.208.552.481.718.82.167.338.274.716.32 1.133.048.416.074.838.079 1.265v.133c0 .214.002.404.008.57a2.527 2.527 0 0 0 .226.977c.073.161.182.336.328.523.25.329.506.66.766.993.26.333.497.677.71 1.03.214.355.389.725.524 1.11.136.386.206.802.211 1.25a3.3 3.3 0 0 1-.164 1.04zm-6.554-8.14c.072 0 .132.018.18.054a.357.357 0 0 1 .109.149.85.85 0 0 1 .054.187c.01.063.016.128.016.196a.282.282 0 0 1-.024.125.27.27 0 0 1-.07.086l-.094.078a.796.796 0 0 0-.093.093.428.428 0 0 1-.149.141 2.129 2.129 0 0 0-.18.117 1.31 1.31 0 0 0-.156.133.264.264 0 0 0-.07.195c0 .047.023.086.07.117a.704.704 0 0 1 .266.305c.052.12.11.237.172.352.062.114.143.21.242.289.099.078.253.117.46.117h.048c.208-.01.406-.065.594-.164.187-.099.375-.203.562-.313a.633.633 0 0 1 .102-.046.37.37 0 0 0 .101-.055l.57-.445a.926.926 0 0 0 .024-.102 2.75 2.75 0 0 0 .016-.11.236.236 0 0 0-.04-.14.4.4 0 0 0-.093-.094.34.34 0 0 0-.133-.054.909.909 0 0 1-.14-.04 1.083 1.083 0 0 1-.352-.14 1.457 1.457 0 0 0-.344-.156c-.02-.006-.036-.021-.047-.047a.983.983 0 0 1-.031-.094.23.23 0 0 1-.008-.102.126.126 0 0 0-.008-.078c0-.062.005-.127.016-.195a.551.551 0 0 1 .07-.195.417.417 0 0 1 .125-.14.411.411 0 0 1 .203-.056c.162 0 .279.06.352.18.073.12.112.25.117.39a.397.397 0 0 1-.039.18.379.379 0 0 0-.04.172c0 .042.014.07.04.086a.26.26 0 0 0 .102.031c.12 0 .197-.028.234-.085a.533.533 0 0 0 .062-.258c0-.12-.01-.253-.03-.399a1.32 1.32 0 0 0-.126-.406.969.969 0 0 0-.242-.313.574.574 0 0 0-.383-.124c-.27 0-.466.067-.586.203-.12.135-.182.338-.187.609 0 .078.005.156.015.234.01.079.016.157.016.235 0 .026-.003.039-.008.039a.218.218 0 0 1-.047-.016 4.263 4.263 0 0 1-.093-.039.774.774 0 0 0-.118-.039.514.514 0 0 0-.203-.008 1.007 1.007 0 0 1-.125.008c-.073 0-.11-.013-.11-.039 0-.078-.004-.177-.015-.297-.01-.12-.036-.24-.078-.36a.995.995 0 0 0-.156-.296c-.063-.078-.156-.12-.281-.125a.323.323 0 0 0-.227.086.905.905 0 0 0-.164.203.64.64 0 0 0-.086.266 5.4 5.4 0 0 1-.031.25 1.459 1.459 0 0 0 .07.406c.026.083.055.156.086.219.031.062.068.093.11.093.025 0 .06-.018.101-.054.042-.037.063-.07.063-.102 0-.016-.008-.026-.024-.031a.147.147 0 0 0-.047-.008c-.036 0-.068-.018-.094-.055a.468.468 0 0 1-.062-.125 5.144 5.144 0 0 1-.047-.148.564.564 0 0 1 .055-.398c.047-.084.133-.128.258-.133zM5.023 15.18c.125 0 .248-.01.368-.032a.97.97 0 0 0 .336-.125.614.614 0 0 0 .234-.242.943.943 0 0 0 .094-.375.816.816 0 0 0-.047-.273.963.963 0 0 0-.133-.25 2.763 2.763 0 0 0-.203-.281 2.763 2.763 0 0 1-.203-.282 62.93 62.93 0 0 1-.29-.43c-.093-.14-.187-.288-.28-.445a8.124 8.124 0 0 1-.235-.406 2.646 2.646 0 0 0-.266-.398 1.203 1.203 0 0 0-.218-.211.469.469 0 0 0-.29-.094.436.436 0 0 0-.296.11 2.26 2.26 0 0 0-.258.265 3.241 3.241 0 0 1-.297.305c-.11.099-.25.177-.422.234a.744.744 0 0 0-.312.172c-.073.073-.11.185-.11.336 0 .104.008.208.024.312.015.104.026.209.031.313 0 .14-.02.273-.063.398a1.157 1.157 0 0 0-.062.367c0 .141.05.24.148.297.1.058.211.097.336.117.157.027.305.047.446.063.14.016.278.04.414.07.135.032.27.065.406.102.135.036.279.094.43.172.03.015.078.034.14.054l.211.07c.078.027.151.048.219.063a.741.741 0 0 0 .148.024zm2.86-.938c.146 0 .302-.015.469-.047a3.54 3.54 0 0 0 .976-.336 2.59 2.59 0 0 0 .406-.257.222.222 0 0 0 .032-.047.305.305 0 0 0 .023-.063v-.008c.031-.114.057-.24.078-.375a8.63 8.63 0 0 0 .055-.414 8.98 8.98 0 0 1 .055-.414c.02-.135.039-.268.054-.398.021-.14.047-.276.078-.406.032-.13.073-.253.125-.368a1.03 1.03 0 0 1 .211-.304 1.54 1.54 0 0 1 .344-.25v-.016l-.008-.023a.29.29 0 0 1 .047-.149 1.4 1.4 0 0 1 .117-.164.582.582 0 0 1 .149-.133.946.946 0 0 1 .164-.078 9.837 9.837 0 0 0-.102-.375 4.938 4.938 0 0 1-.094-.375 7.126 7.126 0 0 0-.093-.476 2.954 2.954 0 0 0-.11-.36 1.317 1.317 0 0 0-.18-.32c-.077-.104-.174-.23-.288-.375a1.189 1.189 0 0 1-.118-.156.555.555 0 0 1-.046-.196 2.206 2.206 0 0 0-.047-.203 9.48 9.48 0 0 0-.242-.75 2.91 2.91 0 0 0-.172-.383 3.87 3.87 0 0 0-.172-.289c-.052-.078-.107-.117-.164-.117-.125 0-.274.05-.446.149-.171.099-.354.208-.546.328-.193.12-.38.232-.563.336-.182.104-.346.153-.492.148a.7.7 0 0 1-.43-.148 2.236 2.236 0 0 1-.36-.344c-.109-.13-.2-.242-.273-.336-.073-.094-.127-.146-.164-.156-.041 0-.065.031-.07.093a2.56 2.56 0 0 0-.008.211v.133c0 .032-.005.052-.016.063-.057.12-.12.237-.187.351-.068.115-.135.232-.203.352a1.611 1.611 0 0 0-.219.758c0 .078.005.156.016.234.01.078.036.154.078.227l-.016.03a1.31 1.31 0 0 1-.133.157 1.072 1.072 0 0 0-.132.164 2.796 2.796 0 0 0-.407.93c-.078.333-.12.672-.125 1.015 0 .089.006.178.016.266.01.089.016.177.016.266a.526.526 0 0 1-.008.086.525.525 0 0 0-.008.086.75.75 0 0 1 .313.109c.12.068.25.154.39.258.14.104.274.224.399.36.125.135.244.267.359.398.115.13.198.26.25.39.052.13.086.237.101.32a.444.444 0 0 1-.125.329.955.955 0 0 1-.312.203c.089.156.198.289.328.398.13.11.271.198.422.266.151.068.315.117.492.148.177.032.35.047.516.047zm3.133 1.11c.109 0 .216-.016.32-.047a1.65 1.65 0 0 0 .445-.203c.136-.089.26-.198.375-.329a3.07 3.07 0 0 1 .977-.75l.258-.117a2.18 2.18 0 0 0 .257-.133.962.962 0 0 0 .165-.132.256.256 0 0 0 .078-.188.295.295 0 0 0-.024-.117.58.58 0 0 0-.07-.117 5.136 5.136 0 0 1-.203-.305 1.978 1.978 0 0 1-.149-.297l-.125-.312a2.558 2.558 0 0 1-.11-.352.28.28 0 0 0-.054-.101.53.53 0 0 0-.46-.235.533.533 0 0 0-.266.07l-.266.149a7.335 7.335 0 0 1-.281.148.656.656 0 0 1-.297.07.411.411 0 0 1-.258-.077.636.636 0 0 1-.172-.211 2.218 2.218 0 0 1-.117-.258l-.094-.258a1.26 1.26 0 0 1-.14.188.666.666 0 0 0-.125.203c-.068.156-.11.33-.125.523-.026.302-.06.596-.102.883a4.7 4.7 0 0 1-.21.86 1.914 1.914 0 0 0-.063.273 2.88 2.88 0 0 0-.032.289c0 .255.079.466.235.633.156.166.367.25.633.25z"/></svg>`,
            mac: `<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12.152 6.896c-.948 0-2.415-1.078-3.96-1.04-2.04.027-3.91 1.183-4.961 3.014-2.117 3.675-.546 9.103 1.519 12.09 1.013 1.454 2.208 3.09 3.792 3.039 1.52-.065 2.09-.987 3.935-.987 1.831 0 2.35.987 3.96.948 1.637-.026 2.676-1.48 3.676-2.948 1.156-1.688 1.636-3.325 1.662-3.415-.039-.013-3.182-1.221-3.22-4.857-.026-3.04 2.48-4.494 2.597-4.559-1.429-2.09-3.623-2.324-4.39-2.376-2-.156-3.675 1.09-4.61 1.09zM15.53 3.83c.843-1.012 1.4-2.427 1.245-3.83-1.207.052-2.662.805-3.532 1.818-.78.896-1.454 2.338-1.273 3.714 1.338.104 2.715-.688 3.559-1.701"/></svg>`,
            license: `<svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 2a.75.75 0 01.75.75v.258a33.186 33.186 0 016.668.83.75.75 0 01-.336 1.461 31.28 31.28 0 00-1.103-.232l1.702 7.545a.75.75 0 01-.387.832A4.981 4.981 0 0115 14c-.825 0-1.606-.2-2.294-.556a.75.75 0 01-.387-.832l1.77-7.849a31.743 31.743 0 00-3.339-.254v11.505l5.25.006a.75.75 0 010 1.5H4a.75.75 0 010-1.5l5.25-.006V4.509a31.743 31.743 0 00-3.339.254l1.77 7.849a.75.75 0 01-.387.832A4.981 4.981 0 015 14c-.825 0-1.606-.2-2.294-.556a.75.75 0 01-.387-.832l1.702-7.545c-.372.068-.741.14-1.103.232a.75.75 0 01-.336-1.461 33.186 33.186 0 016.668-.83V2.75A.75.75 0 0110 2z" clip-rule="evenodd"/></svg>`,
            chevron: `<svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"/></svg>`,
            info: `<svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z" clip-rule="evenodd"/></svg>`,
            copy: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>`,
            check: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>`,
            terminal: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg>`,
            package: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16.5 9.4 7.55 4.24"></path><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.29 7 12 12 20.71 7"></polyline><line x1="12" y1="22" x2="12" y2="12"></line></svg>`,
            trash: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>`,
        };

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function createCodeBlock(code, id) {
            return `
                <div class="code-block">
                    <pre>${escapeHtml(code)}</pre>
                    <button class="copy-btn" onclick="copyToClipboard('${id}', this)" title="Copy to clipboard">
                        ${icons.copy}
                    </button>
                    <input type="hidden" id="${id}" value="${escapeHtml(code)}">
                </div>
            `;
        }

        function createInstallPanel(appName, env, platform, binaryName) {
            const isBeta = env === 'beta';
            const isLinux = platform === 'linux';
            const isMacos = platform === 'macos';
            const repoPath = isBeta ? `${appName}-beta` : appName;
            
            const quickInstallCmd = `curl -fsSL https://genobj.github.io/download-center/${appName}/install.sh | bash${isBeta ? ' -s -- beta' : ''}`;
            const aptCmd = `echo "deb [trusted=yes] https://genobj.github.io/download-center/${repoPath} linux/" | sudo tee /etc/apt/sources.list.d/${repoPath}.list && sudo apt update`;
            const uninstallLinuxCmd = `sudo apt remove ${binaryName}  # or: sudo dpkg -r ${binaryName}`;
            const uninstallMacosCmd = `sudo rm /usr/local/bin/${binaryName}`;
            
            const panelId = `panel-${appName}-${env}-${platform}`;
            const quickId = `quick-${appName}-${env}-${platform}`;
            const aptId = `apt-${appName}-${env}-${platform}`;
            const uninstallId = `uninstall-${appName}-${env}-${platform}`;
            
            let content = `
                <div class="install-method">
                    <div class="install-method-title">${icons.terminal} Quick Install</div>
                    ${createCodeBlock(quickInstallCmd, quickId)}
                </div>
            `;
            
            if (isLinux) {
                content += `
                    <div class="install-method">
                        <div class="install-method-title">${icons.package} APT Repository (Debian/Ubuntu)</div>
                        ${createCodeBlock(aptCmd, aptId)}
                    </div>
                    <div class="install-method">
                        <div class="install-method-title">${icons.trash} Uninstall</div>
                        ${createCodeBlock(uninstallLinuxCmd, uninstallId)}
                    </div>
                `;
            }
            
            if (isMacos) {
                content += `
                    <div class="install-method">
                        <div class="install-method-title">${icons.trash} Uninstall</div>
                        ${createCodeBlock(uninstallMacosCmd, uninstallId)}
                    </div>
                `;
            }
            
            return `
                <div class="install-panel" id="${panelId}">
                    <div class="install-panel-content">
                        ${content}
                    </div>
                </div>
            `;
        }

        function createPlatformButton(platform, url, appName, env) {
            const platformConfig = {
                windows: { name: 'Windows', icon: 'windows', hasDropdown: false },
                linux: { name: 'Linux', icon: 'linux', hasDropdown: true },
                macos: { name: 'macOS', icon: 'mac', hasDropdown: true },
            };
            
            const config = platformConfig[platform];
            const btnId = `btn-${appName}-${env}-${platform}`;
            
            if (!url) {
                return `<span class="platform-btn inactive">${icons[config.icon]} ${config.name}</span>`;
            }
            
            if (config.hasDropdown) {
                return `<button class="platform-btn" id="${btnId}" onclick="togglePlatformPanel('${appName}', '${env}', '${platform}')">
                    ${icons[config.icon]} ${config.name} <span class="chevron">${icons.chevron}</span>
                </button>`;
            } else {
                return `<a href="${url}" class="platform-btn">${icons[config.icon]} ${config.name}</a>`;
            }
        }

        function formatDate(dateStr) {
            if (!dateStr) return '';
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
        }

        function createReleaseCard(appName, env, version, platformData, pubDate, binaryName) {
            const isProduction = env === 'production';
            const badgeClass = isProduction ? 'badge-production' : 'badge-beta';
            const badgeText = isProduction ? 'Product' : 'Beta';
            const formattedDate = formatDate(pubDate);
            
            const winUrl = platformData?.['windows-x86_64']?.url || null;
            const linuxUrl = platformData?.['linux-x86_64']?.url || null;
            const macUrl = platformData?.['darwin-x86_64']?.url || platformData?.['darwin-aarch64']?.url || null;
            
            const platformButtons = `
                ${createPlatformButton('windows', winUrl, appName, env)}
                ${createPlatformButton('linux', linuxUrl, appName, env)}
                ${createPlatformButton('macos', macUrl, appName, env)}
            `;
            
            const installPanels = `
                ${createInstallPanel(appName, env, 'linux', binaryName)}
                ${createInstallPanel(appName, env, 'macos', binaryName)}
            `;

            return `
                <div class="release-card" id="card-${appName}-${env}">
                    <div class="release-header">
                        <div class="release-info">
                            <span class="badge ${badgeClass}">${badgeText}</span>
                            ${formattedDate ? `<span class="release-date">${formattedDate}</span>` : ''}
                            <span class="version">${version}</span>
                        </div>
                        <div class="platform-buttons">
                            ${platformButtons}
                        </div>
                    </div>
                    ${installPanels}
                </div>
            `;
        }

        function togglePlatformPanel(appName, env, platform) {
            const panelId = `panel-${appName}-${env}-${platform}`;
            const btnId = `btn-${appName}-${env}-${platform}`;
            const panel = document.getElementById(panelId);
            const btn = document.getElementById(btnId);
            
            // Close other panels in the same card
            const card = document.getElementById(`card-${appName}-${env}`);
            card.querySelectorAll('.install-panel.expanded').forEach(p => {
                if (p.id !== panelId) {
                    p.classList.remove('expanded');
                }
            });
            card.querySelectorAll('.platform-btn.expanded').forEach(b => {
                if (b.id !== btnId) {
                    b.classList.remove('expanded');
                }
            });
            
            panel.classList.toggle('expanded');
            btn.classList.toggle('expanded');
        }

        async function copyToClipboard(inputId, button) {
            const input = document.getElementById(inputId);
            const text = input.value;
            
            try {
                await navigator.clipboard.writeText(text);
                button.innerHTML = icons.check;
                button.classList.add('copied');
                
                setTimeout(() => {
                    button.innerHTML = icons.copy;
                    button.classList.remove('copied');
                }, 2000);
            } catch (err) {
                input.type = 'text';
                input.select();
                document.execCommand('copy');
                input.type = 'hidden';
                
                button.innerHTML = icons.check;
                button.classList.add('copied');
                
                setTimeout(() => {
                    button.innerHTML = icons.copy;
                    button.classList.remove('copied');
                }, 2000);
            }
        }

        async function fetchLatestJson(path) {
            try {
                const response = await fetch(`${path}/latest.json`);
                if (response.ok) {
                    return await response.json();
                }
            } catch (e) {}
            return null;
        }

        async function loadAppData() {
            const container = document.getElementById('app-container');
            
            for (const app of apps) {
                const section = document.createElement('section');
                section.className = 'app-section';
                section.innerHTML = `
                    <h2 class="app-title">
                        <a href="${app.name}/latest.json" target="_blank">
                            ${app.name} ${icons.external}
                        </a>
                    </h2>
                    <div class="releases" id="${app.name}-releases">
                        <div class="release-card">
                            <div class="release-header">
                                <div class="release-info">
                                    <span class="badge badge-production">Product</span>
                                    <span class="version">Loading...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(section);

                const [prodData, betaData] = await Promise.all([
                    fetchLatestJson(app.name),
                    fetchLatestJson(`${app.name}-beta`)
                ]);

                const releasesDiv = document.getElementById(`${app.name}-releases`);
                releasesDiv.innerHTML = '';

                const prodVersion = prodData?.version || '—';
                releasesDiv.innerHTML += createReleaseCard(app.name, 'production', prodVersion, prodData?.platforms, prodData?.pub_date, app.binary);

                const betaVersion = betaData?.version || '—';
                releasesDiv.innerHTML += createReleaseCard(app.name, 'beta', betaVersion, betaData?.platforms, betaData?.pub_date, app.binary);
            }

            container.innerHTML += `
                <div class="license-section">
                    <button class="license-toggle expanded" onclick="toggleLicense()">
                        <h3>
                            ${icons.license}
                            License Agreement
                        </h3>
                        <span class="chevron">${icons.chevron}</span>
                    </button>
                    <div class="license-content expanded" id="license-content">
                        <pre id="license-text">Loading...</pre>
                    </div>
                </div>

                <div class="license-banner">
                    ${icons.info}
                    <p>By downloading software from this page, you agree to the <a href="LICENSE.txt" target="_blank">POLLUX.ai License</a>. This software requires written permission for use.</p>
                </div>
            `;

            loadLicense();
        }

        function toggleLicense() {
            const toggle = document.querySelector('.license-toggle');
            const content = document.getElementById('license-content');
            toggle.classList.toggle('expanded');
            content.classList.toggle('expanded');
        }

        async function loadLicense() {
            try {
                const response = await fetch('LICENSE.txt');
                if (response.ok) {
                    document.getElementById('license-text').textContent = await response.text();
                }
            } catch (e) {
                document.getElementById('license-text').textContent = 'Failed to load license.';
            }
        }

        loadAppData();
    </script>
</body>
</html>
